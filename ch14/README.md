# chap14. 路由

**路由**是一種機制，它會將請求(以URL及HTTP方法來指定)傳送至處理它們的程式碼。如同我們之前看過的，路由之前是檔案式的，如果你將*foo/about.html*放在你的網站，就可以在瀏覽器用*/foo/about.html*路徑來存取它。簡單，但缺乏彈性。而且，你可能沒有注意，在你的URL裡面使用“HTML”已經非常落伍。

在我們深入Express路由的技術層面之前，應該先討論資訊結構(IA)的概念。IA代表**你的內容在概念上的組織**。在開始規劃路由之前，擁有一個可擴展的IA，將會在接下來的過程中給妳很大的好處。

關於IA，Tim Berbers-Lee在1998 URI一篇短文要求我們肩負起一個崇高的責任：

> 站長的責任，就是指派將會被使用2年、20年，及200年的URI。這需要思考、組織及承諾。

想像你某天走進最喜歡的圖書館，但不能找到任何東西。這就是你重新設計URL結構所發生的情形。

認真地想一下妳的URL：它在20年後，還是有意義的嗎？小心地考慮你的內容細目。請有邏輯地將東西分類，並且不要讓自己陷入困境。它是一門科學，也是一門技術。

以下是一些協助你建構持久的IA的建議：

- **不要在你的URL公開技術細節**
- **避免在你的URL使用毫無意義的資訊**
- **避免沒必要的長URL**
- **字詞分隔符號應保持一致**

    使用連字號來分隔單字是常見的做法，底線比較不普遍，而且大部分的SEO專家都推薦它們。

- **不要使用空格或沒辦法打字的字元**

    不要使用英數字元、數字、虛線及底線之外的字元

- **使用小寫的URL**

    使用小寫的優點是，程式碼一定可以自動地產生它。個人覺得小寫的URL比較美觀。
    
## 路由與SEO

如果有些關鍵字很重要——而且有意義——請考慮讓它成為URL的一部分。標題、標頭、內文及中繼說明使用關鍵字，且URL以關鍵字開頭。如果為了縮短URL，就會喪失寶貴的SEO。

但漫不經心地將關鍵字塞到URL是失敗的做法。

## 子網域

除了路徑外，子網域是URL的另一個部分，通常會被用在路由請求上。子網域最好保留給明顯不同的應用程式，例如REST API(*api.meadowlarktravel.com*)或管理介面(*admin.meadowlarktravel.com*)。有時你會因為技術因素使用子網域。例如，使用WorkPress建構部落格，使用blog.meadowlarktravel.com會比較容易(較佳做法是使用代理伺服器，例如Nginx)。通常SEO會使用子網域來將內容分區，因此你應該要保存對SEO而言不重要的網站區域，例如管理區域及API。

Express的路由機制在預設情況下並未考慮子網域：app.get(/about)會處理*http://meadowlarktravel.com/about*、*http://www.meadoowlarktravel.com*與*http://admin.meadowlarktravel.com/about*的請求。如果你想要個別處理子網域，可使用一種稱為vhost的套件(代表virtual host，來自Apache機制，通常處理子網域使用)。首先，安裝套件(`npm install --save vhost`)，接著編輯你的應用程式檔案來建立子網域：

```

```